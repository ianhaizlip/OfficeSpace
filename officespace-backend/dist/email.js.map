{"version":3,"sources":["../src/email.js"],"names":["Email","app","post","callback","email","from","get","to","message","postId","downloadLink","messageOptions","subject","text","html","sendMail","error","info","console","log","err"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;IAEqBA,K;AAGjB,mBAAYC,GAAZ,EAAgB;AAAA;;AAEZ,aAAKA,GAAL,GAAWA,GAAX;AACH;;;;yCAGgBC,I,EAA0B;AAAA,gBAApBC,QAAoB,uEAAT,YAAM,CAAE,CAAC;;;AAGvC,gBAAMF,MAAM,KAAKA,GAAjB;AACA,gBAAMG,QAAQH,IAAIG,KAAlB;;AAEA,gBAAMC,OAAO,iBAAEC,GAAF,CAAMJ,IAAN,EAAW,MAAX,CAAb,CANuC,CAML;AAClC,gBAAMK,KAAK,iBAAED,GAAF,CAAMJ,IAAN,EAAY,IAAZ,CAAX;AACA,gBAAMM,UAAU,iBAAEF,GAAF,CAAMJ,IAAN,EAAY,SAAZ,EAAuB,EAAvB,CAAhB;AACA,gBAAMO,SAAS,iBAAEH,GAAF,CAAMJ,IAAN,EAAY,KAAZ,CAAf;AACA,gBAAMQ,yCAA+BD,MAArC;;AAEA,gBAAIE,iBAAiB;AACjBN,sBAAMA,IADW,EACL;AACZE,oBAAIA,EAFa,EAET;AACRK,yBAAS,6BAHQ;AAIjBC,sBAAML,OAJW;AAKjBM,8BAAYT,IAAZ,8CAAyDK,YAAzD,+CAA+GF,OAA/G;AALiB,aAArB;;AAQA;AACAJ,kBAAMW,QAAN,CAAeJ,cAAf,EAA+B,UAACK,KAAD,EAAQC,IAAR,EAAiB;;AAE5CC,wBAAQC,GAAR,CAAY,gCAAZ,EAA8CC,GAA9C,EAAmDH,IAAnD;;AAEA,uBAAOd,SAASiB,GAAT,EAAcH,IAAd,CAAP;AACH,aALD;AAMH;;;;;;kBApCgBjB,K","file":"email.js","sourcesContent":["import _ from 'lodash'\r\nimport {url} from \"./config\";\r\n\r\nexport default class Email {\r\n\r\n\r\n    constructor(app){\r\n\r\n        this.app = app;\r\n    }\r\n\r\n\r\n    sendDownloadLink(post, callback = () => {}){\r\n\r\n\r\n        const app = this.app;\r\n        const email = app.email;\r\n\r\n        const from = _.get(post,'from');  // post.from;\r\n        const to = _.get(post, 'to');\r\n        const message = _.get(post, 'message', '');\r\n        const postId = _.get(post, '_id');\r\n        const downloadLink = `${url}/share/${postId}`;\r\n\r\n        let messageOptions = {\r\n            from: from, // sender address\r\n            to: to, // list of receivers\r\n            subject: '[Share] Download Invitation',\r\n            text: message,\r\n            html: `<p>${from} has sent to you file. Click <a href=\"${downloadLink}\">here</a> to download.</p><p>Message: ${message}</p>`\r\n        };\r\n\r\n        // send mail with defined transport object\r\n        email.sendMail(messageOptions, (error, info) => {\r\n\r\n            console.log(\"Sending an email with callback\", err, info);\r\n\r\n            return callback(err, info);\r\n        });\r\n    }\r\n}"]}